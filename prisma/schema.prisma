// This is your Prisma schema file,
// learn more about it in the docs: https://pris.ly/d/prisma-schema

generator client {
  provider = "prisma-client-js"
}

datasource db {
  provider = "postgresql"
  url      = env("DATABASE_URL")
}

model Category {
  id          String    @id @default(uuid())
  name        String    @db.VarChar(255)
  slug        String    @unique @db.VarChar(255)
  description String?   @db.Text
  image       String?   @db.Text
  parentId    String?   @map("parent_id")
  isPillar     Boolean   @default(false) @map("is_pillar")
  order       Int       @default(0)
  seoTitle    String?   @map("seo_title") @db.VarChar(255)
  seoDescription String? @map("seo_description") @db.Text
  createdAt   DateTime  @default(now()) @map("created_at")
  updatedAt   DateTime  @updatedAt @map("updated_at")

  parent         Category?        @relation("CategoryToCategory", fields: [parentId], references: [id], onDelete: SetNull)
  children       Category[]       @relation("CategoryToCategory")
  posts          PostCategory[]
  blogPosts      BlogPost[]       @relation("CategoryToBlogPost")

  @@index([slug])
  @@map("categories")
}

model BlogPost {
  id                  String    @id @default(uuid())
  title               String    @db.VarChar(255)
  slug                String    @unique @db.VarChar(255)
  excerpt             String    @db.Text
  content             String    @db.Text
  featuredImage       String?   @map("featured_image") @db.Text
  categoryId          String?   @map("category_id")
  authorId            String?   @map("author_id")
  published           Boolean   @default(false)
  publishedAt         DateTime? @map("published_at") @db.Timestamptz(6)
  seoTitle            String?   @map("seo_title") @db.VarChar(255)
  seoDescription      String?   @map("seo_description") @db.Text
  seoKeywords         String?   @map("seo_keywords") @db.Text
  productId           String?   @map("product_id")
  createdAt           DateTime  @default(now()) @map("created_at")
  updatedAt           DateTime  @updatedAt @map("updated_at")

  category       Category?      @relation("CategoryToBlogPost", fields: [categoryId], references: [id], onDelete: SetNull)
  product        Product?       @relation("ProductToBlogPost", fields: [productId], references: [id], onDelete: SetNull)
  postCategories PostCategory[]

  @@index([categoryId])
  @@index([published])
  @@index([slug])
  @@index([productId])
  @@map("blog_posts")
}

model PostCategory {
  id         String   @id @default(uuid())
  postId     String   @map("post_id")
  categoryId String   @map("category_id")
  createdAt  DateTime @default(now()) @map("created_at")

  post     BlogPost @relation(fields: [postId], references: [id], onDelete: Cascade)
  category Category @relation(fields: [categoryId], references: [id], onDelete: Cascade)

  @@unique([postId, categoryId])
  @@index([postId])
  @@index([categoryId])
  @@map("post_categories")
}

model Product {
  id          String     @id @default(uuid())
  name        String     @db.VarChar(255)
  slug        String     @unique @db.VarChar(255)
  description String     @db.Text
  excerpt     String?    @db.Text
  image       String?    @db.Text
  price       Decimal?   @db.Decimal(10, 2)
  link        String?    @db.Text
  featured    Boolean    @default(false)
  createdAt   DateTime   @default(now()) @map("created_at")
  updatedAt   DateTime   @updatedAt @map("updated_at")

  blogPosts   BlogPost[] @relation("ProductToBlogPost")

  @@index([slug])
  @@index([featured])
  @@map("products")
}

model HomeContent {
  id                  String   @id @default(uuid())
  heroTitle           String?  @map("hero_title") @db.VarChar(255)
  heroSubtitle        String?  @map("hero_subtitle") @db.Text
  heroImageDesktop    String?  @map("hero_image_desktop") @db.Text
  heroImageMobile     String?  @map("hero_image_mobile") @db.Text
  bannerTitle         String?  @map("banner_title") @db.VarChar(255)
  bannerSubtitle      String?  @map("banner_subtitle") @db.Text
  bannerImageDesktop  String?  @map("banner_image_desktop") @db.Text
  bannerImageMobile   String?  @map("banner_image_mobile") @db.Text
  bannerLink          String?  @map("banner_link") @db.Text
  newsletterTitle     String?  @map("newsletter_title") @db.VarChar(255)
  newsletterSubtitle  String?  @map("newsletter_subtitle") @db.Text
  createdAt           DateTime @default(now()) @map("created_at")
  updatedAt           DateTime @updatedAt @map("updated_at")

  @@map("home_content")
}

model Newsletter {
  id        String   @id @default(uuid())
  email     String   @unique @db.VarChar(255)
  createdAt DateTime @default(now()) @map("created_at")
  updatedAt DateTime @updatedAt @map("updated_at")

  @@index([email])
  @@map("newsletter")
}

